# 02. URL과 리소스

## 2.1 인터넷의 리소스 탐색하기

- 인터넷에 흩어진 리소스에 접근하려면 그 위치를 알아야 한다.
- URL이 바로 그 역할을 하며, 프로토콜과 주소 정보를 한데 묶어 표현한다.
- 개발자가 흔히 쓰는 URI라는 용어도 실제로는 대부분 URL을 가리킨다.

> 💡 **URL과 URI 정리:**
> - URL은 URI의 부분집합이다.
> - URI는 URL과 URN으로 나뉘며, URL은 스킴, 서버 주소, 리소스로 구성된다.
> - 스킴은 HTTP가 아닌 다른 프로토콜일 수 있다.

### 2.1.1 URL이 있기 전 암흑의 시대

- 예전에는 FTP, Gopher 등 서비스마다 접근 방식이 제각각이었다.
- URL이 등장하면서 "어떤 방식으로, 어디서, 무엇을" 한 줄로 표현할 수 있게 되었다.

---

## 2.2 URL 문법

- URL은 여러 구성 요소를 특정 구분자로 연결한 문자열이다.
- 스킴마다 세부 형식이 다르지만, 전체적인 뼈대는 거의 동일하다.

> 💡 URL의 일반 형식:
> ```
> <스킴>://<사용자>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
> ```

### 2.2.1 스킴

- 가장 먼저 오는 부분으로, 리소스를 가져오는 데 어떤 프로토콜을 쓸지 결정한다.
- `http`, `https`, `ftp`, `mailto` 등이 대표적이다.
- 애플리케이션은 스킴을 보고 적절한 통신 방법을 선택한다.

### 2.2.2 호스트와 포트

- 호스트는 리소스를 제공하는 장비의 이름(도메인) 또는 IP다.
- 포트는 같은 장비 내에서 특정 서비스로 연결되는 입구 번호다.
- HTTP는 80, HTTPS는 443이 기본이며, 생략 시 해당 값이 자동 적용된다.

### 2.2.3 사용자 이름과 비밀번호

- FTP처럼 인증이 필요한 프로토콜에서 간혹 사용된다.
- 보안 문제로 HTTP에서는 거의 쓰이지 않는다.

### 2.2.4 경로

- 서버 내부에서 원하는 리소스가 어디 있는지 가리킨다.
- `/`로 계층을 구분하며, 유닉스 파일 경로와 형태가 비슷하다.

### 2.2.5 파라미터

- 경로 조각에 세미콜론(`;`)으로 붙이는 부가 정보다.
- 이름=값 형태로 구성되며, 같은 URL 안에서 여러 개 존재할 수 있다.

> 💡 **파라미터 예시:**
> ```
> http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true
> ```
> - `hammers` 경로: `sale=false`
> - `index.html`: `graphics=true`

### 2.2.6 질의 문자열

- `?` 뒤에 붙으며, 서버에 검색 조건 등을 전달한다.
- `이름=값` 쌍을 `&`로 이어붙이는 형식이 일반적이다.

### 2.2.7 프래그먼트

- `#` 뒤에 붙어 문서 내 특정 위치(앵커)를 지정한다.
- 브라우저가 해당 지점으로 스크롤해 주며, 서버에는 전송되지 않는다.

---

## 2.3 단축 URL

### 2.3.1 상대 URL

- 현재 문서의 위치(기저 URL)를 기준으로 경로를 축약해서 표기한다.
- 예: `<a href="./hammers.html">`
- 문서 전체를 다른 디렉터리로 옮겨도 내부 링크가 유지되어 관리가 편하다.
- 브라우저가 기저 URL과 상대 경로를 합쳐 완전한 URL로 변환한다.

### 2.3.2 URL 확장

- 브라우저가 사용자의 입력을 토대로 URL을 자동 완성해 주는 기능이다.
- **호스트명 확장**: `yahoo` → `www.yahoo.com`
- **히스토리 확장**: 방문 기록에서 일치하는 주소를 추천
- 프록시 설정과 충돌하면 예상치 못한 동작이 생길 수 있다.

---

## 2.4 안전하지 않은 문자

- URL은 원래 7비트 US-ASCII만 허용하도록 설계되었다.
- 한글처럼 ASCII 범위를 벗어나는 문자는 그대로 쓸 수 없다.

> 💡 URL은 7비트인 **US-ASCII**로 설계되었다. 영문을 제외한 한글처럼 7비트로 표현할 수 없는 문자의 경우, **이스케이프** 기능으로 안전한 문자로 인코딩한다.

### 2.4.1 URL 문자 집합

- US-ASCII는 영문 알파벳, 숫자, 일부 기호만 포함하는 7비트 체계다.
- 비영어권 문자를 직접 넣으면 깨지거나 오류가 발생한다.

### 2.4.2 인코딩 체계

- 안전하지 않은 문자는 `%XX` 형식으로 바꾼다.
- XX는 해당 바이트의 16진수 값이다.

> 💡 **이스케이프 예시:**
> - `~` → `%7E`
> - 공백 → `%20`
> - `%` → `%25`

### 2.4.3 문자 제한

- URL 구조에서 특별한 의미를 갖는 문자는 예약되어 있다.
- 이런 문자를 데이터로 쓰려면 반드시 인코딩해야 한다.

> 💡 **예약 문자:**
> - `%`: 인코딩 토큰
> - `/`: 경로 구분
> - `#`: 프래그먼트
> - `?`: 질의
> - `:`: 스킴/호스트 구분

### 2.4.4 인코딩 시점

- URL을 최초로 생성하거나 입력받는 쪽에서 인코딩을 처리하는 것이 원칙이다.
- 인코딩 없이 전송하면 서버가 잘못 해석하거나 오류를 반환할 수 있다.

> 💡 브라우저와 같이 최초로 URL을 입력받는 애플리케이션에서 인코딩하는 것이 가장 적절하다.

---

## 2.5 다양한 스킴

| 스킴 | 설명 |
|------|------|
| http | 일반 웹 통신 (기본 포트 80) |
| https | TLS/SSL 암호화 적용 (기본 포트 443) |
| ftp | 파일 전송 프로토콜 |
| mailto | 이메일 주소 지정 |
| file | 로컬 파일 시스템 접근 |

- 대부분의 웹 트래픽은 `http`와 `https`가 차지한다.
- 그 외 스킴은 특수 목적에 맞춰 사용된다.

---

## 2.6 URL의 한계와 미래

- URL은 리소스의 "위치"를 기반으로 하므로, 리소스가 이동하면 링크가 끊긴다.
- URN은 위치가 아닌 "이름"으로 리소스를 식별하려는 시도다.
- PURL(지속 URL)은 중개 서버를 두어 리소스 이동에 유연하게 대응한다.
- URL이 당장 사라지지는 않겠지만, 단점을 보완하는 기술은 계속 발전 중이다.
